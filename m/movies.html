<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="description" content="Discover popular movies on FossBOX Mobile">
  <title>Movies - FossBOX Mobile</title>
  
  <link rel="stylesheet" href="assets/css/mobile.css">
  <script src="assets/js/mobile-config.js"></script>
</head>
<body>
  <!-- Mobile Header -->
  <header class="mobile-header">
    <a href="index.html" class="mobile-logo">
      <img src="../assets/site-logo.png" alt="FossBOX Logo">
      FossBOX
    </a>
    <button class="mobile-menu-toggle" aria-label="Open menu">
      <img src="../assets/hamburger-icon.svg" alt="Menu" style="width: 20px; height: 20px; filter: brightness(0) invert(1);">
    </button>
  </header>

  <!-- Mobile Navigation -->
  <nav class="mobile-nav" id="mobileNav">
    <div class="mobile-nav-header">
      <a href="index.html" class="mobile-logo">FossBOX</a>
      <button class="mobile-nav-close" aria-label="Close menu">‚úï</button>
    </div>
    <div class="mobile-nav-links">
      <a href="index.html">Home</a>
      <a href="movies.html" class="active">Movies</a>
      <a href="tv.html">TV Shows</a>
      <a href="cartoons.html">Cartoons/Anime</a>
      <a href="../index.html">Desktop Site</a>
    </div>
  </nav>
  
  <!-- Mobile Navigation Overlay -->
  <div class="mobile-nav-overlay"></div>

  <!-- Mobile Search -->
  <div class="mobile-search">
    <form class="mobile-search-form">
      <input type="text" placeholder="Search movies..." autocomplete="off">
      <button type="submit">üîç</button>
    </form>
  </div>

  <!-- Filter Controls -->
  <div class="mobile-filters" id="movieFilters">
    <button class="mobile-filter-btn active" data-category="popular">Popular</button>
    <button class="mobile-filter-btn" data-category="now_playing">Now Playing</button>
    <button class="mobile-filter-btn" data-category="upcoming">Upcoming</button>
    <button class="mobile-filter-btn" data-category="top_rated">Top Rated</button>
  </div>

  <!-- Main Content -->
  <main class="mobile-content">
    <section class="mobile-section">
      <div class="mobile-section-header">
        <h1 class="mobile-section-title">Movies</h1>
      </div>
      <div class="mobile-movie-grid" id="movies-grid">
        <div class="loading">Loading movies...</div>
      </div>
    </section>

    <!-- Mobile Pagination -->
    <div class="mobile-pagination" id="mobilePagination">
      <div class="mobile-pagination-container">
        <button class="mobile-page-btn mobile-page-prev" id="prevPageBtn" disabled>‚Äπ Prev</button>
        <div class="mobile-page-numbers" id="pageNumbers">
          <button class="mobile-page-btn mobile-page-number active" data-page="1">1</button>
          <button class="mobile-page-btn mobile-page-number" data-page="2">2</button>
          <button class="mobile-page-btn mobile-page-number" data-page="3">3</button>
          <span class="mobile-page-dots">...</span>
          <button class="mobile-page-btn mobile-page-number" data-page="999">999</button>
        </div>
        <button class="mobile-page-btn mobile-page-next" id="nextPageBtn">Next ‚Ä∫</button>
      </div>
      <div class="mobile-page-info">
        Page <span id="currentPageNumber">1</span> of <span id="totalPages">999</span>
      </div>
    </div>
  </main>

  <!-- Mobile Footer -->
  <footer class="mobile-footer">
    <p>&copy; 2024 FossBOX Mobile. All rights reserved.</p>
    <p><a href="../index.html">Switch to Desktop</a></p>
  </footer>

  <!-- Scripts -->
  <script src="assets/js/mobile-app.js"></script>
  <script>
    // Movies page specific functionality
    class MobileMoviesPage extends MobileApp {
      constructor() {
        super();
        this.currentCategory = 'popular';
        this.setupMovieFilters();
        this.loadMoviesByCategory(this.currentCategory, 1);
      }

      setupMovieFilters() {
        const filterBtns = document.querySelectorAll('#movieFilters .mobile-filter-btn');
        
        filterBtns.forEach(btn => {
          btn.addEventListener('click', () => {
            const category = btn.dataset.category;
            
            // Update active button
            filterBtns.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            // Reset to page 1 and load movies for category
            this.currentCategory = category;
            this.currentPage = 1;
            this.updatePaginationUI();
            this.loadMoviesByCategory(category, 1);
          });
        });
      }

      async loadMoviesByCategory(category, page = 1) {
        const API_KEY = window.FossBOXMobileConfig.api.tmdb.key;
        const moviesGrid = document.getElementById('movies-grid');
        
        if (!moviesGrid || !API_KEY) return;

        moviesGrid.innerHTML = '<div class="loading">Loading movies...</div>';

        try {
          const response = await fetch(
            `https://api.themoviedb.org/3/movie/${category}?api_key=${API_KEY}&page=${page}`
          );
          const data = await response.json();
          
          this.renderMovies(data.results.slice(0, 20), moviesGrid);
          
          // Update total pages based on API response
          if (data.total_pages && data.total_pages < this.totalPages) {
            this.totalPages = Math.min(data.total_pages, 999);
            const totalPagesSpan = document.getElementById('totalPages');
            if (totalPagesSpan) {
              totalPagesSpan.textContent = this.totalPages;
            }
          }
        } catch (error) {
          console.error('Error loading movies:', error);
          moviesGrid.innerHTML = '<div class="loading">Failed to load movies</div>';
        }
      }

      // Override loadContentForPage to load movies by category
      async loadContentForPage(page) {
        await this.loadMoviesByCategory(this.currentCategory, page);
      }
    }

    // Initialize movies page
    document.addEventListener('DOMContentLoaded', () => {
      new MobileMoviesPage();
    });
  </script>
</body>
</html>